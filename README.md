# Влияние аберраций на цифровые изображения <br> (The effect of aberrations on digital images)

В репозитории представлена реализация метода моделирования влияния аберраций на цифровые изображения.
При вычислении комбинации волновых фронтов от исходного изображения и волновой аберрации используется
*преобразование Фурье*. Для представления аберраций используются *полиномы Цернике*.

## Каталоги в этом репозитории

>**demos**: папка, содержащая демонстрацию работы предложенного решения <br>
>**matlab**: папка, содержащая код программы

## Запуск

Запуск осуществляется функцией `ApplyAberrations`: <br>
<br>
`ImgEnd = ApplyAberrations(ImgName,VecParam,alignment,s)`<br>
<br>
где **ImgName** – ссылка на обрабатываемое изображение, например: `Test1.jpg`;<br>
**VecParam** – вид и величина аберраций, вектор параметров имеет следующую форму `[n1,m1,C1;n2,m2,C2,...]`, где `n` и `m` определяют вид аберрации, а `С` - величину аберрации;<br>
**alignment** –  вкл/выкл грубое выравнивание интенсивности;<br>
**s** – коэффициент переэкспонирования.

## Примеры

Пример исходного изображения приближённо являющимся точечным источником:

<figure>
<img src="https://github.com/Stergrim/The-effect-of-aberrations-on-digital-images/blob/main/demos/Test0.jpg" width="200"/>
</figure>

Примеры применения аберраций к точечному источнику. Слева представлен волновой фронт аберрации, а справа соответствующее распределение интенсивности:

<p float="left">
<img src="https://github.com/Stergrim/The-effect-of-aberrations-on-digital-images/blob/main/demos/01.png" width="300" />
<img src="https://github.com/Stergrim/The-effect-of-aberrations-on-digital-images/blob/main/demos/02.png" width="300" /> 
</p>

**Левый рисунок**<br>
**а** и **б** – сферическая `(n = 4; m = 0; С = 4)`;<br>
**в** и **г** – кома OX `(n = 3; m = -1; C = 10)`, переэкспонировано в 5 раз `(s = 5)`;<br>
**д** и **е** – кома OY `(n = 3; m = 1; C = 10)`, переэкспонировано в 5 раз `(s = 5)`. <br>
**Правый рисунок**<br>
**а** и **б** – астигматизм 0° и расфокусировка `(n = 2; m = 2; С = -8 и n = 2; m = 0; C = 8)`, переэкспонировано в 4 раза `(s = 4)`;<br>
**в** и **г** – астигматизм 0° и расфокусировка `(n = 2; m = 2; С = 8 и n = 2; m = 0; C = 8)`, переэкспонировано в 4 раза `(s = 4)`;<br>
**д** и **е** – расфокусировка `(n = 2; m = 0; C = 4)`, переэкспонировано в 2 раза `(s = 2)`.<br>

Примеры применения аберраций к плоскому изображению и к цветному изображению.

<p float="left">
<img src="https://github.com/Stergrim/The-effect-of-aberrations-on-digital-images/blob/main/demos/03.png" width="300" />
<img src="https://github.com/Stergrim/The-effect-of-aberrations-on-digital-images/blob/main/demos/04.png" width="440" /> 
</p>

**Левый рисунок**<br>
**а** – исходное изображение;<br>
**б** – сферическая `(n = 4; m = 0; С = 0.5)` переэкспонировано в 2 раза `(s = 2)`;<br>
**в** – кома OX `(n = 3; m = -1; C = 3)`, переэкспонировано в 2 раз `(s = 2)`;<br>
**г** – кома OY `(n = 3; m = 1; C = 3)`, переэкспонировано в 2 раз `(s = 2)`;<br>
**д** – астигматизм 0° и расфокусировка `(n = 2; m = 2; С = -1 и n = 2; m = 0; C = 1)` переэкспонированое в 2 раза `(s = 2)`;<br>
**е** – астигматизм 0° и расфокусировка `(n = 2; m = 2; С = 1 и n = 2; m = 0; C = 1)` переэкспонированое в 2 раза `(s = 2)`;<br>
**Правый рисунок**<br>
**а** – исходное изображение;<br>
**б** – сферическая `(n = 4; m = 0; С = 0.5)`;<br>
**в** – кома OY `(n = 3; m = 1; C = 3)`;<br>
**г** – астигматизм 0° и расфокусировка `(n = 2; m = 2; С = 2 и n = 2; m = 0; C = 1)`.<br>

## Замечания

Единственным недостатком выбранной системы полиномов (*полиномов Цернике*) является невозможность моделирования *аберрации
дисторсия* к не точечному источнику.

